# 风风博客开发心得（一）：项目总览与架构解析

> 本文为系列开篇，旨在带你快速浏览这个全栈博客项目的“骨架”。  
> 内容已与最新的前后端代码（**2025/12/19 版本**）完全对齐。

## 1. 碎碎念：为什么又要造轮子？

嗨！欢迎来到风风博客的开发手记。👋

老实说，社区上成熟的博客系统多如牛毛，`Wordpress`、`Hexo`、`Halo`……随便拎一个出来都能打。

但作为一个“爱折腾”的爱好者，总觉得别人的轮子虽然圆，但不够顺手（其实就是想自己瞎改）。

于是，这个项目诞生了。起初它只是一个想把 CSS 写出花来的纯前端页面，后来为了能在网页上直接写文章，又硬着头皮写了后端。

现在的它，已经是一个**全栈的动态网站**，不仅有花哨的前台展示，还有一个五脏俱全的**在线内容管理系统 (CMS)**。而且为了让它看起来更酷，我甚至给它整了一套“玻璃拟态”的 UI  
~~虽然代价是显卡风扇偶尔会转得快一点点~~

## 2. 技术栈：简单粗暴但好用

我们的目标是：用最舒服的姿势写代码，拒绝过度设计！

### 2.1 前端 (Frontend) - `src/`

- **核心框架**: Vue 3 (Composition API) + TypeScript + Vite。这一套现在是标配了，开发体验极佳，HMR 热更新快到飞起。
- **状态管理**: Pinia。
  - _小怪癖_：虽然官方推荐把 Store 放在 `src/stores`，但我把它们按照业务模块塞进了 `src/views/stores/`（比如 `articleStore.ts`）。别问，问就是觉得离 View 近一点更有安全感 \(\_/ω＼\_\)。
- **HTTP 通信**: **双轨制策略**。
  - **前台读取**：在 `articleStore.ts` 里，我直接用了原生的 `fetch`。为什么？因为读取文章不需要鉴权，原生 API 轻量又没依赖，少加载一个库是一个库！
  - **后台管理**：在 `adminStore` 里使用了 Axios。所有的魔法都在 `src/api/index.ts` 里，那里藏着一个自动处理 JWT 续签的拦截器，专门对付 401 报错。
- **Markdown**: 使用 `vue-markdown-render` 组件。
  - 在 `src/composables/useArticleContent.ts` 里，我把繁琐的配置（比如 `linkify`, `typographer`）都封装好了。现在渲染文章只需要一行 `<VueMarkdown :source="content" />`，简直不要太爽。

### 2.2 后端 (Backend) - `backend/`

- **核心框架**: Flask。Python 写起来就是快！（性能... 只要给服务器加钱，性能就不是问题！( ˘･з･)）
- **大管家 `app.py`**:
  - 这是一个略显庞大的单文件应用，现在已经快 700 行代码了。
  - 所有的 API 路由、数据库模型（User, Article, Friend...）都在这一个文件里。
  - _独家秘籍_：为了不迷路，我疯狂使用了 `# region ... # endregion` 代码折叠块。虽然这不符合最佳实践，但对于个人博客来说，**找代码只需要滚动鼠标滚轮**，不用在十几个文件里跳来跳去，非常爽的啦awa！
- **数据库**: SQLite + SQLAlchemy。文件型数据库，备份只需要复制一个 `blog.db` 文件，方便的咧。
- **安全**: Flask-JWT-Extended。用来发令牌（Token），保护我们的后台接口不被邪恶怪兽入侵。

## 3. 核心机制：它是怎么跑起来的？

### 3.1 数据的流动

整个应用的数据流非常清晰，我们以“保存文章”为例：

1.  **用户操作**: 你在后台编辑器里敲完字，点击“保存”。
2.  **Axios 发车**: 请求带着 `access_token` 冲向后端。
3.  **拦截器查票**: (`src/api/index.ts`) 就像一个尽职的门卫，它会检查 Token 是否过期。如果过期了，它会暂停请求，偷偷拿着 Refresh Token 去后端换个新的，然后再把原请求发出去。这一切对用户都是无感的——除非你的 Refresh Token 也过期了，那只能请你重新登录啦。
4.  **Flask 接单**: `app.py` 里的 `save_article` 路由接收 JSON 数据。
5.  **ORM 落库**: SQLAlchemy 把数据塞进 `blog.db`。

### 3.2 静态资源的大迁徙 (Legacy Data)

这是一个比较有趣的坑，也是我最近重构的重点。

以前我把图片都放在 `public/` 下，但这导致“演示静态文件”和“网站自己的静态文件”混在一起，很乱。

现在，我引入了一个 **`legacy_data/`** 目录，作为项目的“种子库”。这里存放了所有的预制 Markdown 文章和示例图片。

为了让新下载项目的朋友能一键拥有完整内容，我写了一个脚本 `backend/init_db.py`。

当你运行它时，它会化身“搬运工”：

1.  **清空数据库**：把旧表删得干干净净（`clear_data`）。
2.  **物理搬运**：把 `legacy_data/friends` 和 `legacy_data/artwork` 里的图片，强行复制到后端的 `backend/static/` 目录下。
3.  **数据注入**：读取 `legacy_data/article/index.json`，把里面的 Markdown 内容读取出来，写入 SQLite 数据库。

这样，无论你是上传的新图，还是以前的老图，后端都能统一通过 `/static/...` 路径吐出来，Nginx 配置起来也更简单了！

## 4. 怎么把这玩意跑起来？

如果你想在本地把玩一下，需要同时启动前后端“双引擎”。

### 4.1 启动后端引擎

进入 `backend/` 目录，准备好 Python 环境：

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 创建管理员账号 (这是我在 app.py 里特意留的一个 CLI 命令)
# 它会提示你输入用户名和密码，并自动初始化数据库表
# 放心，它会自动检测表是否存在的！
flask create-admin

# 3. (可选) 填充示例数据
# 警告：这会清空现有数据！它会把 legacy_data/ 下的预制文章和图片导入数据库
# 适合第一次跑项目的时候用
python init_db.py

# 4. 点火！
python app.py
```

### 4.2 启动前端引擎

回到项目根目录：

```bash
npm install
npm run dev
```

现在，打开浏览器访问 `http://localhost:5173`，你应该能看到那个花里胡哨的首页了。

## 5. 下集预告

这一篇只是个开胃菜。接下来，我们会深入到具体的实现细节中去。

下一篇，我们将聊聊**前端架构设计与页面布局**。我会讲讲我是如何用 CSS 把页面做成“玻璃质感”的，以及那个让我掉头发的响应式布局（尤其是那个 `ReflectionLayer`，简直是显卡杀手）。

Stay tuned!

---

> 没有未来的小风酱 著  
> 2025-12-19 更新 （已核对最新源码——）
